<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<meta charset="UTF-8">

<head th:replace="~{parts/common :: header}">
    <title>Work page</title>
</head>
<p>
<h5 th:inline="text">Здравствуйте, [[${#httpServletRequest.remoteUser}]]!
    <form th:action="@{/logout}" method="post">
    <input type="submit" value="Sign Out"/>
</form></h5>

</p>
<div sec:authorize="hasAnyAuthority('ADMIN')"><a href="/admin">Перейти к администрированию</a> </div>
</p>

<div>
    <form th:action="@{/main}" method="post">
        <div><label> Напишите обращение <input type="text" name="text"/> </label></div>
        <div><input type="submit" value="Отправить"/></div>
    </form>
</div>

</p>
<div>
<form th:action="@{/filter}" method="post">
    <div><input type="submit" value="Показать мои обращения"/></div>
</form>
</div>
</p>

<div>
    <form th:action="@{/allapp}" method="post">
        <div><input type="submit" value="Показать все обращения"/></div>
    </form>
</div>
</p>
<table>
    <tr>
        <th>Id</th>
        <th>Author</th>
        <th>Application</th>
        <th>Date accepted</th>
        <th>Done accepted</th>
        <th>Status</th>
        <th>Response</th>
    </tr>
    <tr th:each="app : ${applications}">
        <td th:text="${app.id}"></td>
        <td th:text="${app.author.username}"></td>
        <td th:text="${app.text}"></td>
        <td th:text="${app.addtimestamp.toString().substring(0,16)}"></td>
        <td th:text="${app.donetimestamp}"></td>
        <td th:text="${app.status}"></td>
        <td th:text="${app.response}"></td>
    </tr>
</table>


</body>
</html>